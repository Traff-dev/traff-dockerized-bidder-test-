window.onload=function(){var xhr,url="http://www.creative.traff.co/server/index.php";function getData(){if(xhr&&4==xhr.readyState&&200==xhr.status){console.log(xhr.responseText);var data=JSON.parse(xhr.responseText);if(1==data.status)switch(data.action){case"get_banner":data.links.forEach(element=>set_link(element))}}}function set_link(element){var old_link=document.getElementById(element.id),el=document.createElement("html");el.innerHTML=element.CODE,new_link=el.getElementsByTagName("a")[0],"none"==element.alter_link?old_link.setAttribute("href",new_link.getAttribute("href")):old_link.setAttribute("href",element.alter_link),old_link.innerHTML=new_link.innerHTML,old_link.setAttribute("onclick",'xhr = new XMLHttpRequest();xhr.open("POST", "'+url+'", true);xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");var pst = "action=click&id="+id;xhr.send(pst);return true;')}function send_to_server(prm){if(xhr=new XMLHttpRequest)try{xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onreadystatechange=getData;var pst="",raz="";for(var key in prm)pst+=raz+key+"="+prm[key],raz="&";xhr.send(pst)}catch(e){console.log("Banner replacement: Could not connect to server:\n"+e.toString())}}function add_script(id){var element=document.createElement("script");element.setAttribute("type","text/javascript"),document.body.appendChild(element)}let arr=new Array;for(var links=document.getElementsByTagName("a"),i=0;i<links.length;i++){var id=links[i].getAttribute("id");id&&"traff_"===id.substr(0,6)&&arr.push(id)}var parm;send_to_server({action:"get_banner",arr_id:arr})};